#!/usr/bin/env bash

# If -f, then put computer to sleep.
# Otherwise, lock screen and turn off monitor.



sleep_prepare () {
  playerctl pause&
  # i3lock can't grab the cursor if another application is handling it
  systemctl --user stop hhpc

  i3lock-color --clock --color=191c21 --datestr='%A %Y-%m-%d' --radius 30 --ring-width 10 --timepos="-100:+30"
  sleep 1
}

if [[ $1 == -h ]]; then
  bin=${0##*/}
  echo "Usage: $bin [-f]"
  echo
  echo "  $bin       # put display to sleep"
  echo "  $bin -f    # put computer to sleep"
elif [[ $1 == -f ]]; then
  echo "Going to sleep..."
  sleep_prepare
  systemctl suspend
else
  echo "Shutting my eyes..."
  sleep_prepare
  xset dpms force off
fi
