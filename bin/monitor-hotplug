#!/usr/bin/env bash
# Sets right perspective when monitor is plugged in
export DISPLAY=:0

function connectLG(){
  xrandr \
    --output VIRTUAL1 \
    --off \
    --output DP2 \
    --off \
    --output DP1 \
    --off \
    --output HDMI2 \
    --off \
    --output HDMI1 \
    --off \
    --output eDP1 \
    --off \
    --output DP2 \
    --primary \
    --mode 3840x2160 \
    --pos 0x0 \
    --scale 1.5x1.5 \
    --rotate normal
}

function disconnect(){
  xrandr \
    --output VIRTUAL1 \
    --off \
    --output DP1 \
    --off \
    --output DP2 \
    --off \
    --output DP1 \
    --off \
    --output HDMI1 \
    --off \
    --output HDMI2 \
    --off \
    --output eDP1 \
    --primary \
    --mode 1920x1080 \
    --pos 0x0 \
    --rotate normal
}

if [[ $(xrandr | grep "^DP2 connected") ]]; then
  connectLG
else
  disconnect
fi

# only relaunch bars if not init mode
if ! [ "$INIT_MODE" = "1" ]; then
  sleep 1
  echo "re-launching bars"
  /home/floscr/.config/polybar/launch.sh
fi
